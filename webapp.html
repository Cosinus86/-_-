<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        
        #app {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 95%;
            height: 90%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        #header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        #close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #section-title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            flex-grow: 1;
        }
        
        #media-grid {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .media-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }
        
        .media-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .media-preview {
            width: 100%;
            height: 160px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 50px;
            position: relative;
            cursor: pointer;
        }
        
        .media-preview.video::before {
            content: "‚ñ∂";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .media-preview.audio::before {
            content: "‚ô™";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .order-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .media-info {
            padding: 15px;
        }
        
        .media-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .reactions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .reaction-btn {
            background: #f8f9fa;
            border: none;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            margin: 0 2px;
            justify-content: center;
        }
        
        .reaction-btn:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }
        
        .reaction-btn.active {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .reaction-btn.likes { color: #4CAF50; }
        .reaction-btn.eyes { color: #FF9800; }
        .reaction-btn.confused { color: #9C27B0; }
        .reaction-btn.mindblown { color: #f44336; }
        
        .reaction-count {
            font-weight: bold;
            font-size: 12px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: #f44336;
            text-align: center;
            padding: 40px;
            font-size: 18px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        
        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            #app {
                width: 100%;
                height: 100%;
                border-radius: 0;
            }
            
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .reaction-btn span {
                display: none;
            }
            
            .reaction-btn {
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .media-preview {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="header">
            <button id="close-btn">‚úï</button>
            <div id="section-title">–ú–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞</div>
            <div style="width: 40px;"></div>
        </div>
        
        <div id="media-grid">
            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <script>
        // Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞–∑–¥–µ–ª–∞ –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const sectionId = urlParams.get('section') || '1';
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const closeBtn = document.getElementById('close-btn');
        const sectionTitle = document.getElementById('section-title');
        const mediaGrid = document.getElementById('media-grid');
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const userReactions = new Map();
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ Web App
        closeBtn.addEventListener('click', () => {
            tg.close();
        });
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ - –ë–ï–ó –û–ñ–ò–î–ê–ù–ò–Ø –ó–ê–ì–†–£–ó–ö–ò
        const testData = {
            success: true,
            section: {
                id: sectionId,
                name: sectionId === '1' ? 'üé¨ –§–∏–ª—å–º—ã' : sectionId === '2' ? 'üí¨ –û–±—â–µ–Ω–∏–µ' : 'üìÅ –†–∞–∑–¥–µ–ª ' + sectionId,
                description: '–ú–µ–¥–∏–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'
            },
            media: [
                {
                    id: 1,
                    file_id: 'test1',
                    type: 'video',
                    title: '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã',
                    order: 1,
                    reactions: { likes: 15, eyes: 3, confused: 2, mindblown: 8 }
                },
                {
                    id: 2,
                    file_id: 'test2',
                    type: 'video',
                    title: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏',
                    order: 2,
                    reactions: { likes: 7, eyes: 1, confused: 0, mindblown: 2 }
                },
                {
                    id: 3,
                    file_id: 'test3',
                    type: 'audio',
                    title: '–ê—É–¥–∏–æ –∑–∞–ø–∏—Å—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π',
                    order: 3,
                    reactions: { likes: 12, eyes: 4, confused: 1, mindblown: 3 }
                },
                {
                    id: 4,
                    file_id: 'test4',
                    type: 'video',
                    title: '–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–∫—Ü–∏—è–º–∏ –∏ –æ—Ü–µ–Ω–∫–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞',
                    order: 4,
                    reactions: { likes: 23, eyes: 5, confused: 3, mindblown: 12 }
                },
                {
                    id: 5,
                    file_id: 'test5',
                    type: 'video',
                    title: '–ö–∞–∫ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —á–µ—Ä–µ–∑ –±–æ—Ç–∞',
                    order: 5,
                    reactions: { likes: 9, eyes: 2, confused: 1, mindblown: 4 }
                },
                {
                    id: 6,
                    file_id: 'test6',
                    type: 'audio',
                    title: '–ü–æ–¥–∫–∞—Å—Ç –æ –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö —Å–∏—Å—Ç–µ–º—ã',
                    order: 6,
                    reactions: { likes: 18, eyes: 6, confused: 2, mindblown: 7 }
                },
                {
                    id: 7,
                    file_id: 'test7',
                    type: 'video',
                    title: '–í–∏–¥–µ–æ-–æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ —Ä–∞–±–æ—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã',
                    order: 7,
                    reactions: { likes: 14, eyes: 2, confused: 0, mindblown: 5 }
                },
                {
                    id: 8,
                    file_id: 'test8',
                    type: 'audio',
                    title: '–ú—É–∑—ã–∫–∞ –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã',
                    order: 8,
                    reactions: { likes: 11, eyes: 1, confused: 1, mindblown: 2 }
                }
            ]
        };
        
        // –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        function initializeApp() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web App, —Ä–∞–∑–¥–µ–ª:', sectionId);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            sectionTitle.textContent = testData.section.name;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            displaySectionData(testData);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            setTimeout(() => {
                tg.showAlert('‚úÖ Web App —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!\n\n–î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ.');
            }, 500);
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞
        function displaySectionData(data) {
            // –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
            mediaGrid.innerHTML = '';
            
            if (!data.media || data.media.length === 0) {
                showEmptyState();
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
            data.media.forEach(media => {
                const card = createMediaCard(media);
                mediaGrid.appendChild(card);
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
        function createMediaCard(media) {
            const card = document.createElement('div');
            card.className = 'media-card';
            
            // –û–±—Ä–µ–∑–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
            const shortTitle = media.title.length > 40 
                ? media.title.substring(0, 37) + '...' 
                : media.title;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥–ª—è —Ç–∏–ø–∞ –º–µ–¥–∏–∞
            const mediaIcon = media.type === 'video' ? 'fa-video' : 'fa-music';
            const mediaClass = media.type === 'video' ? 'video' : 'audio';
            
            card.innerHTML = `
                <div class="media-preview ${mediaClass}" data-media-id="${media.id}">
                    <div class="order-badge">#${media.order}</div>
                    <i class="fas ${mediaIcon}"></i>
                </div>
                <div class="media-info">
                    <div class="media-title" title="${media.title}">${shortTitle}</div>
                    <div class="reactions">
                        <button class="reaction-btn likes" data-reaction="likes" data-media-id="${media.id}">
                            <i class="fas fa-thumbs-up"></i>
                            <span>–ö–ª–∞—Å—Å</span>
                            <span class="reaction-count">${media.reactions.likes}</span>
                        </button>
                        <button class="reaction-btn eyes" data-reaction="eyes" data-media-id="${media.id}">
                            <i class="fas fa-eye"></i>
                            <span>–ì–ª–∞–∑–∞</span>
                            <span class="reaction-count">${media.reactions.eyes}</span>
                        </button>
                        <button class="reaction-btn confused" data-reaction="confused" data-media-id="${media.id}">
                            <i class="fas fa-question-circle"></i>
                            <span>–ù–µ –ø–æ–Ω–∏–º–∞—é</span>
                            <span class="reaction-count">${media.reactions.confused}</span>
                        </button>
                        <button class="reaction-btn mindblown" data-reaction="mindblown" data-media-id="${media.id}">
                            <i class="fas fa-brain"></i>
                            <span>–í–∑—Ä—ã–≤ –º–æ–∑–≥–∞</span>
                            <span class="reaction-count">${media.reactions.mindblown}</span>
                        </button>
                    </div>
                </div>
            `;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –ø—Ä–µ–≤—å—é
            const preview = card.querySelector('.media-preview');
            preview.addEventListener('click', () => {
                playMedia(media);
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–µ–∞–∫—Ü–∏–π
            const reactionButtons = card.querySelectorAll('.reaction-btn');
            reactionButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    handleReaction(
                        media.id,
                        button.dataset.reaction,
                        button
                    );
                });
            });
            
            return card;
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–µ–¥–∏–∞
        function playMedia(media) {
            const message = media.type === 'video' 
                ? `üé¨ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ: "${media.title}"`
                : `üéµ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ: "${media.title}"`;
            
            tg.showAlert(message + '\n\n–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç –º–µ–¥–∏–∞-—Ñ–∞–π–ª.');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏
        function handleReaction(mediaId, reactionType, button) {
            const key = `${mediaId}_${reactionType}`;
            
            // –ï—Å–ª–∏ —Ä–µ–∞–∫—Ü–∏—è —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ - —Å–Ω–∏–º–∞–µ–º
            if (userReactions.has(key)) {
                userReactions.delete(key);
                button.classList.remove('active');
                
                // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) - 1;
                
            } else {
                // –£–¥–∞–ª—è–µ–º –¥—Ä—É–≥–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —ç—Ç–æ–≥–æ –º–µ–¥–∏–∞
                for (const [existingKey] of userReactions) {
                    if (existingKey.startsWith(`${mediaId}_`)) {
                        userReactions.delete(existingKey);
                        
                        // –°–Ω–∏–º–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–Ω–æ–ø–∫–∏
                        const prevReaction = existingKey.split('_')[1];
                        const prevButton = document.querySelector(
                            `.reaction-btn[data-media-id="${mediaId}"][data-reaction="${prevReaction}"]`
                        );
                        if (prevButton) {
                            prevButton.classList.remove('active');
                            
                            // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä–µ–∞–∫—Ü–∏–∏
                            const prevCount = prevButton.querySelector('.reaction-count');
                            prevCount.textContent = parseInt(prevCount.textContent) - 1;
                        }
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ä–µ–∞–∫—Ü–∏—é
                userReactions.set(key, true);
                button.classList.add('active');
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) + 1;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const reactionNames = {
                    'likes': 'üëç –ö–ª–∞—Å—Å',
                    'eyes': 'üëÄ –ì–ª–∞–∑–∞',
                    'confused': '‚ùì –ù–µ –ø–æ–Ω–∏–º–∞—é',
                    'mindblown': 'üí• –í–∑—Ä—ã–≤ –º–æ–∑–≥–∞'
                };
                
                tg.showAlert(`–í—ã –ø–æ—Å—Ç–∞–≤–∏–ª–∏ —Ä–µ–∞–∫—Ü–∏—é: ${reactionNames[reactionType]}\n\n–†–µ–∞–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ.`);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        function showEmptyState() {
            mediaGrid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-film"></i>
                    <h3>–†–∞–∑–¥–µ–ª –ø—É—Å—Ç</h3>
                    <p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç –º–µ–¥–∏–∞-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</p>
                    <p>–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ –∏–ª–∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ:</p>
                    <ol style="text-align: left; display: inline-block; margin-top: 10px;">
                        <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –≤ —Ç–µ–º–µ –≥—Ä—É–ø–ø—ã</li>
                        <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ —Ñ–∞–π–ª</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª</li>
                    </ol>
                </div>
            `;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ - –ù–ï–ú–ï–î–õ–ï–ù–ù–û
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏: –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
        console.log('Web App –∑–∞–≥—Ä—É–∂–µ–Ω. –î–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: window.reloadData()');
        window.reloadData = function() {
            initializeApp();
            tg.showAlert('–î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    tg.showAlert('–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                } else {
                    tg.showAlert('–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç Telegram
        if (tg.onEvent) {
            tg.onEvent('viewportChanged', () => {
                console.log('–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω');
            });
            
            tg.onEvent('closed', () => {
                console.log('Web App –∑–∞–∫—Ä—ã—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º');
            });
        }
    </script>
</body>
</html>            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        #close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #section-title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            flex-grow: 1;
        }
        
        #media-grid {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .media-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }
        
        .media-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .media-preview {
            width: 100%;
            height: 160px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 50px;
            position: relative;
            cursor: pointer;
        }
        
        .media-preview.video::before {
            content: "‚ñ∂";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .media-preview.audio::before {
            content: "‚ô™";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .order-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .media-info {
            padding: 15px;
        }
        
        .media-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .reactions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .reaction-btn {
            background: #f8f9fa;
            border: none;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            margin: 0 2px;
            justify-content: center;
        }
        
        .reaction-btn:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }
        
        .reaction-btn.active {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .reaction-btn.likes { color: #4CAF50; }
        .reaction-btn.eyes { color: #FF9800; }
        .reaction-btn.confused { color: #9C27B0; }
        .reaction-btn.mindblown { color: #f44336; }
        
        .reaction-count {
            font-weight: bold;
            font-size: 12px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: #f44336;
            text-align: center;
            padding: 40px;
            font-size: 18px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        
        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            #app {
                width: 100%;
                height: 100%;
                border-radius: 0;
            }
            
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .reaction-btn span {
                display: none;
            }
            
            .reaction-btn {
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .media-preview {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="header">
            <button id="close-btn">‚úï</button>
            <div id="section-title">–ú–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞</div>
            <div style="width: 40px;"></div>
        </div>
        
        <div id="media-grid">
            <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <script>
        // Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞–∑–¥–µ–ª–∞ –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const sectionId = urlParams.get('section') || '1';
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const closeBtn = document.getElementById('close-btn');
        const sectionTitle = document.getElementById('section-title');
        const mediaGrid = document.getElementById('media-grid');
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const userReactions = new Map();
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ Web App
        closeBtn.addEventListener('click', () => {
            tg.close();
        });
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ - –ë–ï–ó –û–ñ–ò–î–ê–ù–ò–Ø –ó–ê–ì–†–£–ó–ö–ò
        const testData = {
            success: true,
            section: {
                id: sectionId,
                name: sectionId === '1' ? 'üé¨ –§–∏–ª—å–º—ã' : sectionId === '2' ? 'üí¨ –û–±—â–µ–Ω–∏–µ' : 'üìÅ –†–∞–∑–¥–µ–ª ' + sectionId,
                description: '–ú–µ–¥–∏–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'
            },
            media: [
                {
                    id: 1,
                    file_id: 'test1',
                    type: 'video',
                    title: '–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã',
                    order: 1,
                    reactions: { likes: 15, eyes: 3, confused: 2, mindblown: 8 }
                },
                {
                    id: 2,
                    file_id: 'test2',
                    type: 'video',
                    title: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏',
                    order: 2,
                    reactions: { likes: 7, eyes: 1, confused: 0, mindblown: 2 }
                },
                {
                    id: 3,
                    file_id: 'test3',
                    type: 'audio',
                    title: '–ê—É–¥–∏–æ –∑–∞–ø–∏—Å—å –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π',
                    order: 3,
                    reactions: { likes: 12, eyes: 4, confused: 1, mindblown: 3 }
                },
                {
                    id: 4,
                    file_id: 'test4',
                    type: 'video',
                    title: '–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–∫—Ü–∏—è–º–∏ –∏ –æ—Ü–µ–Ω–∫–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞',
                    order: 4,
                    reactions: { likes: 23, eyes: 5, confused: 3, mindblown: 12 }
                },
                {
                    id: 5,
                    file_id: 'test5',
                    type: 'video',
                    title: '–ö–∞–∫ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —á–µ—Ä–µ–∑ –±–æ—Ç–∞',
                    order: 5,
                    reactions: { likes: 9, eyes: 2, confused: 1, mindblown: 4 }
                },
                {
                    id: 6,
                    file_id: 'test6',
                    type: 'audio',
                    title: '–ü–æ–¥–∫–∞—Å—Ç –æ –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö —Å–∏—Å—Ç–µ–º—ã',
                    order: 6,
                    reactions: { likes: 18, eyes: 6, confused: 2, mindblown: 7 }
                },
                {
                    id: 7,
                    file_id: 'test7',
                    type: 'video',
                    title: '–í–∏–¥–µ–æ-–æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ —Ä–∞–±–æ—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã',
                    order: 7,
                    reactions: { likes: 14, eyes: 2, confused: 0, mindblown: 5 }
                },
                {
                    id: 8,
                    file_id: 'test8',
                    type: 'audio',
                    title: '–ú—É–∑—ã–∫–∞ –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã',
                    order: 8,
                    reactions: { likes: 11, eyes: 1, confused: 1, mindblown: 2 }
                }
            ]
        };
        
        // –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        function initializeApp() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web App, —Ä–∞–∑–¥–µ–ª:', sectionId);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            sectionTitle.textContent = testData.section.name;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            displaySectionData(testData);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            setTimeout(() => {
                tg.showAlert('‚úÖ Web App —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!\n\n–î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ.');
            }, 500);
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞
        function displaySectionData(data) {
            // –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
            mediaGrid.innerHTML = '';
            
            if (!data.media || data.media.length === 0) {
                showEmptyState();
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
            data.media.forEach(media => {
                const card = createMediaCard(media);
                mediaGrid.appendChild(card);
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
        function createMediaCard(media) {
            const card = document.createElement('div');
            card.className = 'media-card';
            
            // –û–±—Ä–µ–∑–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
            const shortTitle = media.title.length > 40 
                ? media.title.substring(0, 37) + '...' 
                : media.title;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥–ª—è —Ç–∏–ø–∞ –º–µ–¥–∏–∞
            const mediaIcon = media.type === 'video' ? 'fa-video' : 'fa-music';
            const mediaClass = media.type === 'video' ? 'video' : 'audio';
            
            card.innerHTML = `
                <div class="media-preview ${mediaClass}" data-media-id="${media.id}">
                    <div class="order-badge">#${media.order}</div>
                    <i class="fas ${mediaIcon}"></i>
                </div>
                <div class="media-info">
                    <div class="media-title" title="${media.title}">${shortTitle}</div>
                    <div class="reactions">
                        <button class="reaction-btn likes" data-reaction="likes" data-media-id="${media.id}">
                            <i class="fas fa-thumbs-up"></i>
                            <span>–ö–ª–∞—Å—Å</span>
                            <span class="reaction-count">${media.reactions.likes}</span>
                        </button>
                        <button class="reaction-btn eyes" data-reaction="eyes" data-media-id="${media.id}">
                            <i class="fas fa-eye"></i>
                            <span>–ì–ª–∞–∑–∞</span>
                            <span class="reaction-count">${media.reactions.eyes}</span>
                        </button>
                        <button class="reaction-btn confused" data-reaction="confused" data-media-id="${media.id}">
                            <i class="fas fa-question-circle"></i>
                            <span>–ù–µ –ø–æ–Ω–∏–º–∞—é</span>
                            <span class="reaction-count">${media.reactions.confused}</span>
                        </button>
                        <button class="reaction-btn mindblown" data-reaction="mindblown" data-media-id="${media.id}">
                            <i class="fas fa-brain"></i>
                            <span>–í–∑—Ä—ã–≤ –º–æ–∑–≥–∞</span>
                            <span class="reaction-count">${media.reactions.mindblown}</span>
                        </button>
                    </div>
                </div>
            `;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –ø—Ä–µ–≤—å—é
            const preview = card.querySelector('.media-preview');
            preview.addEventListener('click', () => {
                playMedia(media);
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–µ–∞–∫—Ü–∏–π
            const reactionButtons = card.querySelectorAll('.reaction-btn');
            reactionButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    handleReaction(
                        media.id,
                        button.dataset.reaction,
                        button
                    );
                });
            });
            
            return card;
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–µ–¥–∏–∞
        function playMedia(media) {
            const message = media.type === 'video' 
                ? `üé¨ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ: "${media.title}"`
                : `üéµ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ: "${media.title}"`;
            
            tg.showAlert(message + '\n\n–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç –º–µ–¥–∏–∞-—Ñ–∞–π–ª.');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏
        function handleReaction(mediaId, reactionType, button) {
            const key = `${mediaId}_${reactionType}`;
            
            // –ï—Å–ª–∏ —Ä–µ–∞–∫—Ü–∏—è —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ - —Å–Ω–∏–º–∞–µ–º
            if (userReactions.has(key)) {
                userReactions.delete(key);
                button.classList.remove('active');
                
                // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) - 1;
                
            } else {
                // –£–¥–∞–ª—è–µ–º –¥—Ä—É–≥–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —ç—Ç–æ–≥–æ –º–µ–¥–∏–∞
                for (const [existingKey] of userReactions) {
                    if (existingKey.startsWith(`${mediaId}_`)) {
                        userReactions.delete(existingKey);
                        
                        // –°–Ω–∏–º–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–Ω–æ–ø–∫–∏
                        const prevReaction = existingKey.split('_')[1];
                        const prevButton = document.querySelector(
                            `.reaction-btn[data-media-id="${mediaId}"][data-reaction="${prevReaction}"]`
                        );
                        if (prevButton) {
                            prevButton.classList.remove('active');
                            
                            // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä–µ–∞–∫—Ü–∏–∏
                            const prevCount = prevButton.querySelector('.reaction-count');
                            prevCount.textContent = parseInt(prevCount.textContent) - 1;
                        }
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ä–µ–∞–∫—Ü–∏—é
                userReactions.set(key, true);
                button.classList.add('active');
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) + 1;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                const reactionNames = {
                    'likes': 'üëç –ö–ª–∞—Å—Å',
                    'eyes': 'üëÄ –ì–ª–∞–∑–∞',
                    'confused': '‚ùì –ù–µ –ø–æ–Ω–∏–º–∞—é',
                    'mindblown': 'üí• –í–∑—Ä—ã–≤ –º–æ–∑–≥–∞'
                };
                
                tg.showAlert(`–í—ã –ø–æ—Å—Ç–∞–≤–∏–ª–∏ —Ä–µ–∞–∫—Ü–∏—é: ${reactionNames[reactionType]}\n\n–†–µ–∞–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ.`);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        function showEmptyState() {
            mediaGrid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-film"></i>
                    <h3>–†–∞–∑–¥–µ–ª –ø—É—Å—Ç</h3>
                    <p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç –º–µ–¥–∏–∞-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</p>
                    <p>–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ –∏–ª–∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ:</p>
                    <ol style="text-align: left; display: inline-block; margin-top: 10px;">
                        <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –≤ —Ç–µ–º–µ –≥—Ä—É–ø–ø—ã</li>
                        <li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ —Ñ–∞–π–ª</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª</li>
                    </ol>
                </div>
            `;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ - –ù–ï–ú–ï–î–õ–ï–ù–ù–û
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏: –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
        console.log('Web App –∑–∞–≥—Ä—É–∂–µ–Ω. –î–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: window.reloadData()');
        window.reloadData = function() {
            initializeApp();
            tg.showAlert('–î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    tg.showAlert('–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                } else {
                    tg.showAlert('–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç Telegram
        if (tg.onEvent) {
            tg.onEvent('viewportChanged', () => {
                console.log('–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω');
            });
            
            tg.onEvent('closed', () => {
                console.log('Web App –∑–∞–∫—Ä—ã—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º');
            });
        }
    </script>
</body>
</html>            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        #close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #section-title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            flex-grow: 1;
        }
        
        #media-grid {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .media-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }
        
        .media-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .media-preview {
            width: 100%;
            height: 160px;
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 50px;
            position: relative;
            cursor: pointer;
        }
        
        .media-preview.video::before {
            content: "‚ñ∂";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .media-preview.audio::before {
            content: "‚ô™";
            font-size: 40px;
            background: rgba(0,0,0,0.7);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .order-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .media-info {
            padding: 15px;
        }
        
        .media-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .reactions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .reaction-btn {
            background: #f8f9fa;
            border: none;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            margin: 0 2px;
            justify-content: center;
        }
        
        .reaction-btn:hover {
            background: #e9ecef;
            transform: scale(1.05);
        }
        
        .reaction-btn.active {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .reaction-btn.likes { color: #4CAF50; }
        .reaction-btn.eyes { color: #FF9800; }
        .reaction-btn.confused { color: #9C27B0; }
        .reaction-btn.mindblown { color: #f44336; }
        
        .reaction-count {
            font-weight: bold;
            font-size: 12px;
        }
        
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            color: #f44336;
            text-align: center;
            padding: 40px;
            font-size: 18px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        
        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            #app {
                width: 100%;
                height: 100%;
                border-radius: 0;
            }
            
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }
            
            .reaction-btn span {
                display: none;
            }
            
            .reaction-btn {
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            #media-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .media-preview {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="header">
            <button id="close-btn">‚úï</button>
            <div id="section-title">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div style="width: 40px;"></div>
        </div>
        
        <div id="media-grid">
            <div class="loading">
                <div class="loading-spinner"></div>
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏...</p>
            </div>
        </div>
    </div>

    <script>
        // Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞–∑–¥–µ–ª–∞ –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const sectionId = urlParams.get('section');
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const BOT_TOKEN = '7672802314:AAF00aFiUc88iiqZoMKDHKQTE6wfNBIbgL4';
        const API_BASE_URL = `https://api.telegram.org/bot${BOT_TOKEN}`;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const closeBtn = document.getElementById('close-btn');
        const sectionTitle = document.getElementById('section-title');
        const mediaGrid = document.getElementById('media-grid');
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∞–∫—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const userReactions = new Map();
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ Web App
        closeBtn.addEventListener('click', () => {
            tg.close();
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞ —Ä–∞–∑–¥–µ–ª–∞ —Å —Ä–µ–∞–ª—å–Ω–æ–≥–æ API
        async function loadSectionMedia() {
            if (!sectionId) {
                showError('–ù–µ —É–∫–∞–∑–∞–Ω —Ä–∞–∑–¥–µ–ª');
                return;
            }
            
            try {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ–¥–∏–∞
                const response = await sendCommandToBot(`/getmedia ${sectionId}`);
                
                if (response && response.success) {
                    displaySectionData(response);
                } else {
                    // –ï—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ
                    showMockData();
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                showMockData();
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç—É —á–µ—Ä–µ–∑ Telegram API
        async function sendCommandToBot(command) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Backend –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
            // –≠—Ç–æ –ø—Ä–∏–º–µ—Ä –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            
            try {
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± - —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
                // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–µ–Ω –≤–∞—à —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
                
                // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ–º mock –¥–∞–Ω–Ω—ã–µ
                return getMockData();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥—ã:', error);
                return null;
            }
        }
        
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        function getMockData() {
            return {
                success: true,
                section: {
                    id: sectionId,
                    name: sectionId === '1' ? '–§–∏–ª—å–º—ã' : '–û–±—â–µ–Ω–∏–µ',
                    description: '–ú–µ–¥–∏–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã'
                },
                media: [
                    {
                        id: 1,
                        file_id: 'BAACAgIAAxkBAAIBcmbFvIAAAbK1p7P0esvVwABb4ZunDAACXisAAq3oWUj0MQj7hL4G1jQE',
                        type: 'video',
                        title: '–ü—Ä–∏–º–µ—Ä –≤–∏–¥–µ–æ 1',
                        order: 1,
                        reactions: { likes: 5, eyes: 2, confused: 1, mindblown: 3 }
                    },
                    {
                        id: 2,
                        file_id: 'BAACAgIAAxkBAAIBc2bFvIAAAbK1p7P0esvVwABb4ZunDAACXisAAq3oWUj0MQj7hL4G1jQE',
                        type: 'video',
                        title: '–ü—Ä–∏–º–µ—Ä –≤–∏–¥–µ–æ 2',
                        order: 2,
                        reactions: { likes: 3, eyes: 1, confused: 0, mindblown: 1 }
                    }
                ]
            };
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        function showMockData() {
            const mockData = getMockData();
            displaySectionData(mockData);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            tg.showAlert('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ. –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞.');
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞
        function displaySectionData(data) {
            if (!data.success || !data.media) {
                showError('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                return;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            sectionTitle.textContent = data.section.name;
            
            // –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
            mediaGrid.innerHTML = '';
            
            if (data.media.length === 0) {
                showEmptyState();
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
            data.media.forEach(media => {
                const card = createMediaCard(media);
                mediaGrid.appendChild(card);
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –º–µ–¥–∏–∞
        function createMediaCard(media) {
            const card = document.createElement('div');
            card.className = 'media-card';
            
            // –û–±—Ä–µ–∑–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
            const shortTitle = media.title.length > 50 
                ? media.title.substring(0, 47) + '...' 
                : media.title;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥–ª—è —Ç–∏–ø–∞ –º–µ–¥–∏–∞
            const mediaIcon = media.type === 'video' ? 'fa-video' : 'fa-music';
            const mediaClass = media.type === 'video' ? 'video' : 'audio';
            
            card.innerHTML = `
                <div class="media-preview ${mediaClass}" data-media-id="${media.id}">
                    <div class="order-badge">#${media.order}</div>
                    <i class="fas ${mediaIcon}"></i>
                </div>
                <div class="media-info">
                    <div class="media-title" title="${media.title}">${shortTitle}</div>
                    <div class="reactions">
                        <button class="reaction-btn likes" data-reaction="likes" data-media-id="${media.id}">
                            <i class="fas fa-thumbs-up"></i>
                            <span>–ö–ª–∞—Å—Å</span>
                            <span class="reaction-count">${media.reactions.likes}</span>
                        </button>
                        <button class="reaction-btn eyes" data-reaction="eyes" data-media-id="${media.id}">
                            <i class="fas fa-eye"></i>
                            <span>–ì–ª–∞–∑–∞</span>
                            <span class="reaction-count">${media.reactions.eyes}</span>
                        </button>
                        <button class="reaction-btn confused" data-reaction="confused" data-media-id="${media.id}">
                            <i class="fas fa-question-circle"></i>
                            <span>–ù–µ –ø–æ–Ω–∏–º–∞—é</span>
                            <span class="reaction-count">${media.reactions.confused}</span>
                        </button>
                        <button class="reaction-btn mindblown" data-reaction="mindblown" data-media-id="${media.id}">
                            <i class="fas fa-brain"></i>
                            <span>–í–∑—Ä—ã–≤ –º–æ–∑–≥–∞</span>
                            <span class="reaction-count">${media.reactions.mindblown}</span>
                        </button>
                    </div>
                </div>
            `;
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –ø—Ä–µ–≤—å—é
            const preview = card.querySelector('.media-preview');
            preview.addEventListener('click', () => {
                playMedia(media);
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–µ–∞–∫—Ü–∏–π
            const reactionButtons = card.querySelectorAll('.reaction-btn');
            reactionButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    handleReaction(
                        media.id,
                        button.dataset.reaction,
                        button
                    );
                });
            });
            
            return card;
        }
        
        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–µ–¥–∏–∞ —á–µ—Ä–µ–∑ Telegram
        function playMedia(media) {
            if (media.type === 'video') {
                // –î–ª—è –≤–∏–¥–µ–æ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ Telegram
                tg.showAlert(`üé¨ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ: ${media.title}\n\n–§–∞–π–ª –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç –≤ Telegram...`);
                
                // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ Telegram
                setTimeout(() => {
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å file_id –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
                    tg.openLink(`https://t.me/`);
                }, 1000);
                
            } else {
                // –î–ª—è –∞—É–¥–∏–æ
                tg.showAlert(`üéµ –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ: ${media.title}`);
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏
        async function handleReaction(mediaId, reactionType, button) {
            const key = `${mediaId}_${reactionType}`;
            
            // –ï—Å–ª–∏ —Ä–µ–∞–∫—Ü–∏—è —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ - —Å–Ω–∏–º–∞–µ–º
            if (userReactions.has(key)) {
                userReactions.delete(key);
                button.classList.remove('active');
                
                // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) - 1;
                
            } else {
                // –£–¥–∞–ª—è–µ–º –¥—Ä—É–≥–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —ç—Ç–æ–≥–æ –º–µ–¥–∏–∞
                for (const [existingKey] of userReactions) {
                    if (existingKey.startsWith(`${mediaId}_`)) {
                        userReactions.delete(existingKey);
                        
                        // –°–Ω–∏–º–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–Ω–æ–ø–∫–∏
                        const prevReaction = existingKey.split('_')[1];
                        const prevButton = document.querySelector(
                            `.reaction-btn[data-media-id="${mediaId}"][data-reaction="${prevReaction}"]`
                        );
                        if (prevButton) {
                            prevButton.classList.remove('active');
                            
                            // –£–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ä–µ–∞–∫—Ü–∏–∏
                            const prevCount = prevButton.querySelector('.reaction-count');
                            prevCount.textContent = parseInt(prevCount.textContent) - 1;
                        }
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ä–µ–∞–∫—Ü–∏—é
                userReactions.set(key, true);
                button.classList.add('active');
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                const countSpan = button.querySelector('.reaction-count');
                countSpan.textContent = parseInt(countSpan.textContent) + 1;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                try {
                    await sendReactionToServer(mediaId, reactionType);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∞–∫—Ü–∏–∏:', error);
                }
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        async function sendReactionToServer(mediaId, reactionType) {
            // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –±–æ—Ç—É
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–º–∞–Ω–¥—É /react —á–µ—Ä–µ–∑ Telegram API
            console.log(`–†–µ–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: media=${mediaId}, reaction=${reactionType}`);
            
            // –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tg.sendData –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–æ—Ç–∞
            if (tg.sendData) {
                tg.sendData(JSON.stringify({
                    action: 'reaction',
                    media_id: mediaId,
                    reaction: reactionType
                }));
            }
            
            return new Promise(resolve => setTimeout(resolve, 300));
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏
        function showError(message) {
            mediaGrid.innerHTML = `
                <div class="error">
                    <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 20px;"></i>
                    <h3>–û—à–∏–±–∫–∞</h3>
                    <p>${message}</p>
                    <button onclick="loadSectionMedia()" style="
                        margin-top: 20px;
                        padding: 10px 20px;
                        background: #3498db;
                        color: white;
                        border: none;
                        border-radius: 5px;
                        cursor: pointer;
                    ">
                        –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                    </button>
                </div>
            `;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        function showEmptyState() {
            mediaGrid.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-film"></i>
                    <h3>–†–∞–∑–¥–µ–ª –ø—É—Å—Ç</h3>
                    <p>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç –º–µ–¥–∏–∞-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</p>
                    <p>–î–æ–±–∞–≤—å—Ç–µ –≤–∏–¥–µ–æ –∏–ª–∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ</p>
                </div>
            `;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            loadSectionMedia();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª
                    tg.showAlert('–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)');
                } else {
                    // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª
                    tg.showAlert('–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)');
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
        tg.onEvent('viewportChanged', (event) => {
            console.log('Viewport changed:', event);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
        tg.onEvent('closed', () => {
            console.log('Web App –∑–∞–∫—Ä—ã—Ç');
        });
    </script>
</body>
</html>
